import { describe, it } from "node:test";

import { csl, OfflineEvaluator } from "@meshsdk/core-csl";
import { BlockfrostProvider, UTxO } from "@meshsdk/core";

describe("test", () => {
  const fetcher = new BlockfrostProvider(
    "preprodV7dWeNmimVypuKDgsDCkEuRhKxsonOxk"
  );
  const evaluator = new OfflineEvaluator(fetcher, "preprod");

  it("script test", async () => {
    const tx = csl.Transaction.from_hex(
      "84a700d9010283825820486215372c0ed5247f10524e281e49b03511de08ba666aeb6fbcc2187891679902825820b4d2c065c903577147faa2d1d9e6116686f1c2e1046c4b8321582e546c9ced7e01825820ca5d9a3cce4a8451627da914c9bb9ceb94495da66a7ef8d677548af86ccb53b4010183a300581d701ae2ac6d29affe92a2783b3c852eb266935fb80b02ea6530d04be0a601821a0016e360a1581c0a58d318181a384a81d79e73697c8df0a5e1362fd310f0c5501beb32a14001028201d8185846d8799f9f581c60edd22048ec0169ffd4e3ab38c9588a7ef86e16f461a1ad239b56175820000de140afb8a51e61565cd663fb9e2a970486d82492260ed86e5d677f7b11b2ffff82583900afb8a51e61565cd663fb9e2a970486d82492260ed86e5d677f7b11b27ba2c5e1a661b966b8082a4e3eea6e31af1a2054bef7916bbac25c2d821b000000012996b574a2581c1c24687602c866101d41aa64e39685ee7092f26af15c5329104141fda1446d65736801581c60edd22048ec0169ffd4e3ab38c9588a7ef86e16f461a1ad239b5617a15820000de140afb8a51e61565cd663fb9e2a970486d82492260ed86e5d677f7b11b2018258390008d9d743d6ee8cbec90836b8eb7a0563698a0d2a3b154cbad9ca13467c16240714ea0e12b41a914f2945784ac494bb19573f0ca61a08afa8821b000000014ccf4fb6a2581c1c24687602c866101d41aa64e39685ee7092f26af15c5329104141fda1446d65736801581c60edd22048ec0169ffd4e3ab38c9588a7ef86e16f461a1ad239b5617a15820000de140afb8a51e61565cd663fb9e2a970486d82492260ed86e5d677f7b11b201021bffffffffffffffff09a1581c0a58d318181a384a81d79e73697c8df0a5e1362fd310f0c5501beb32a140010b58202de8f95554802011b6eb801af26174e50cadc1df188fb77cdfcc1d3a16526ad30dd9010281825820486215372c0ed5247f10524e281e49b03511de08ba666aeb6fbcc218789167990512d9010281825820b4d2c065c903577147faa2d1d9e6116686f1c2e1046c4b8321582e546c9ced7e00a207d9010281590e84590e810101003323232323232322322598009919191919299919805180098059baa00213232323232598009803000c4c8c8c8c96600260320050068b202c375c602e002602e0046eb8c054004c044dd50044566002600600315980098089baa0088014590124566002600800315980098089baa00880145901245900f201e403c601e6ea801c4c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c966002603a0051323322323259800981880144c8c9660026048605c6ea800626464b3001303500289919192cc004c0e000a2646464b3001303b0028acc004c0ecc8c8cc004004094896600200314bd7044cc8966002b30013375e607e60786ea80080162605c64b3001302f303c375400314800226eb4c100c0f4dd5000a07632598009817981e1baa0018a60103d87a8000899198008009bab3041303e375400444b30010018a6103d87a80008994c004dd7181f800cdd69820000cc1100092225980099b910190038acc004cdc780c801c4c0accc114dd400125eb82298103d87a8000410513300600600141043042001410081d8c8cc004004dd598201820981e9baa0032259800800c530103d87a80008994c004dd7181f000cdd5981f800cc10c0092225980099b910190038acc004cdc780c801c4c0a8cc110dd300125eb82298103d87a800041011330060060014100304100140fd14a081d226607c0046600800800313300400400140e8607a002607c00281d8c040c0dcdd51810181b9baa0018acc00402a2b30010038cc00408a057488100a4004809229410354528206a8b20708b2070303900132330010010232259800800c52f5c113322598009815992cc004c0b0c0e4dd5000c5200089bad303d303a375400281c0c966002605860726ea80062980103d87a8000899198008009bab303e303b375400444b30010018a6103d87a80008994c004dd7181e000cdd6981e800cc1040092225980099b910160038acc004cdc780b001c4c0a0cc108dd400125eb82298103d87a800040f913300600600140f8303f00140f481c0c8cc004004dd5981e981f181d1baa303d303e303a375400644b30010018a60103d87a80008994c004dd7181d800cdd5981e000cc1000092225980099b910160038acc004cdc780b001c4c09ccc104dd300125eb82298103d87a800040f513300600600140f4303e00140f113303b00233004004001899802002000a06e303a001303b00140e066ebc018c070cc0d8dd39981b1ba900b33036375201497ae04bd704590351bae30360013036002375c60680031640c86eb0c0cc004c0bcdd5000c5902d192cc004c088c0b8dd5000c4c0c8c0bcdd5000c5902d18189819181918171baa00230203259800800c52000899191800992cc00400e2900044c008cc004004c0d400d032112cc0040062900044c00ccc008008c0d80050331b8048008c0c800502f19198008009bab3017302e375400444b30010018a5eb82264646464660020026eacc0cc010896600200310038991981b9ba733037375200a6606e60680026606e606a00297ae0330030033039002303700140d466008008606a0066eb8c0bc004c0c800503045902e1817800991980080080c112cc004006297ae0899912cc0056600266ebcc0c8c0bcdd5001006c4c8cc004004c8cc004004dd5981a181a98189baa0042259800800c52f5c1132323232330010013756606c00844b30010018801c4c8cc0e8dd39981d1ba90053303a30370013303a30380014bd7019801801981e001181d000a070330040043038003375c6064002606a0028198896600200314a1133225980099b8f375c606c00404f14a313300400400140c46eb0c0d0004c0d40050324528205a89981880119802002000c4cc01001000502d18180009818800a05c375c60580026eb8c0b0c0b4004c0a0dd500fc56600260340051323259800cc00405603d488100a4002800a33001015803c00a900120028a5040a044446464b30010018014566002606600313233225980099b8f002007899b870010068a5040c06eb8c0cc004dd69819981a00098199bac3032001801206040c06466002002601600c44b30010018a5eb8226644b30013371e6eb8c02c0080222660686e9c008cc0100100062660080080028180dd61819800981a000a06214a06464b3001302e0028992cc004c080c0a8dd5000c4c8c9660026062005132325329800981100144cdc59800801a44100899b8b3001337060060053001222598009812800c4cdc5980200124500899b8b300433706004003300100399b8600200199b8300148051003206299b8600300299b8300248051222598009812800c4cdc5980200124500899b8b300433706004003300100399b8600200199b83001480510032062205c370090302cc004cdc4000a402914800a26644b300133710002900a4520148cc00400a66e0c0052014a419002801102e1112cc004cdc40012402910018cc00400e66e0c009201499b8200148051003205e33706002900a2058375a6060605a6ea800e2c8170dd6981780098159baa0018b20523259800980f18151baa0018981718159baa0018b2052302d302e302e302a3754602660546ea80062c8158c0b0004c8cc004004058896600200314bd7044cc8966002b30013375e605e60586ea8c0bcc0c0c0b0dd5001005c4c078c966002603e60586ea80062900044dd6981818169baa00140ac64b3001301f302c375400314c103d87a8000899198008009bab3031302e375400444b30010018a6103d87a80008994c004dd71817800cdd69818000cc0d00092225980099b914881000038acc004cdc7a441000038980d9981a9ba80024bd704530103d87a800040c513300600600140c4303200140c08158c8cc004004dd59818181898169baa30303031302d375400644b30010018a60103d87a80008994c004dd71817000cdd59817800cc0cc0092225980099b910120038acc004cdc7809001c4c068cc0d0dd300125eb82298103d87a800040c113300600600140c0303100140bd14a0815226605c0046600800800313300400400140a8605a002605c002815a264b3001980080a4076910100a40028022200314a08138ca600200300b805200222259800801452844cc8966002646600200203044b30010018a50899912cc004cdc78010034528c4cc01001000502f1bae3032001303300140c115980099b884800800e33001005800ccdc0001a4002802a294502b46600200b001801a00a40ac6eb8c0b8008c0bc00902c204c409846056002604a6ea80748888c8c9660020030028acc004c0bc006264653001375c6060005375c6060003375a606060620029112cc004cdc7801805456600266e3c008026266e1c004022294102e4528205c18180009bac302e001801205840b0600c00a29408c8cc004004008896600200314bd7044ca60026eb8c09c0066eacc0a00066600600660580049111919800800801912cc004006200713233030374e660606ea4018cc0c0c0b4004cc0c0c0b80052f5c06600600660640046060002817060540028140dd718131813803181280298120029bae3023005375a604400a6eb0c084014c084c084004c080004c07cc07cc07c004c078c078004c064dd51919192cc004c044c06cdd5000c4c966002602460386ea800626464646464646464646464646464646464646464646464646464646464646464646464646464b300130470028991980080081311192cc00400a26605804026605803826605803026605802826605802026605801826605801026605800c20551323002304b003375c60920048238c00800a2c8220dd71822800982280118218009821801182080098208011bae303f001303f002303d001303d002375c60760026076004607200260720046eb8c0dc004c0dc008c0d4004c0d4008dd718198009819801181880098188011bae302f001302f002302d001302d002375c60560026056004605200260520046eb8c09c004c09c008dd6981280098128011b99375c604600260460046eb0c084004c074dd5000c5901b19192cc004c04c0062d1598009808000c5a26042603c6ea800901c2038301c3754002603e6040604060386ea8c014c070dd5180f980e1baa0018b203432330010013758603e01844b30010018a6103d87a8000899912cc004c044c9660026024603e6ea80062900044dd6981198101baa001407864b30013012301f375400314c103d87a8000899198008009bab30243021375400444b30010018a6103d87a80008994c004dd71811000cdd69811800cc09c0092225980099b914881000038acc004cdc7a4410000389807198141ba80024bd704530103d87a8000409113300600600140903025001408c80f0c8cc004004dd5980498101baa30093020375400644b30010018a60103d87a80008994c004dd71810800cdd59811000cc0980092225980099b910210038acc004cdc7810801c4c034cc09cdd300125eb82298103d87a8000408d133006006001408c3024001408913007330210024bd7044cc01001000501d18100009810800a03c22598009808980d9baa0028991919192cc004c09000a26600e006264b30013016001899192cc004c09c00a264b30013019001899192cc004c0a800a26601a00201716409c605000260486ea800a2b3001301600189919191919192cc004c0b800a01f1640ac6eb4c0b0004c0b0008dd6981500098150011bad3028001302437540051640888110c088dd5000c59024181280098109baa0028acc004c04c0062b3001302137540050068b20448b203e407c603e6ea80062c8108c088004c088008c080004c070dd500145901a11192cc004c04400626464b3001302200280245901f1bae3020001301c37540071598009807000c4c8c96600260440050048b203e375c604000260386ea800e2c80d101a180d1baa002374a90001180d980e0009bac3019301a301a301a301a004375660300066eb0c05c00cdd6180b002180b180b000980a800980a00098079baa007370e90011b8748010dd7180798061baa002370e90000b1806980700198060011805801180580098031baa0018a4d1365640106eb80055cd2ab9d5573caae7d5d02ba1574498011e581ca57faffd16a011c4d66b42337e29704f051ceb96a0fecceedab57097000105a182010082d8799f581c60edd22048ec0169ffd4e3ab38c9588a7ef86e16f461a1ad239b56175820000de140afb8a51e61565cd663fb9e2a970486d82492260ed86e5d677f7b11b2ff821a006acfc01ab2d05e00f5f6"
    );
    // const utxos: UTxO[] = [];
    // for (let i = 0; i < tx.body().inputs().len(); i++) {
    //   const utxo = tx.body().inputs().get(i);
    //   utxos.push(
    //     (
    //       await fetcher.fetchUTxOs(utxo.transaction_id().to_hex(), utxo.index())
    //     )[0]
    //   );
    // }
    // if (tx.body().reference_inputs()) {
    //   for (let i = 0; i < tx.body().reference_inputs()!.len(); i++) {
    //     const utxo = tx.body().inputs().get(i);
    //     utxos.push(
    //       (
    //         await fetcher.fetchUTxOs(
    //           utxo.transaction_id().to_hex(),
    //           utxo.index()
    //         )
    //       )[0]
    //     );
    //   }
    // }
    // if (tx.body().collateral()) {
    //   for (let i = 0; i < tx.body().collateral()!.len(); i++) {
    //     const utxo = tx.body().inputs().get(i);
    //     utxos.push(
    //       (
    //         await fetcher.fetchUTxOs(
    //           utxo.transaction_id().to_hex(),
    //           utxo.index()
    //         )
    //       )[0]
    //     );
    //   }
    // }

    // evaluator.evaluateTx(
    //   "84a700d9010283825820486215372c0ed5247f10524e281e49b03511de08ba666aeb6fbcc2187891679902825820b4d2c065c903577147faa2d1d9e6116686f1c2e1046c4b8321582e546c9ced7e01825820ca5d9a3cce4a8451627da914c9bb9ceb94495da66a7ef8d677548af86ccb53b4010183a300581d701ae2ac6d29affe92a2783b3c852eb266935fb80b02ea6530d04be0a601821a0016e360a1581c0a58d318181a384a81d79e73697c8df0a5e1362fd310f0c5501beb32a14001028201d8185846d8799f9f581c60edd22048ec0169ffd4e3ab38c9588a7ef86e16f461a1ad239b56175820000de140afb8a51e61565cd663fb9e2a970486d82492260ed86e5d677f7b11b2ffff82583900afb8a51e61565cd663fb9e2a970486d82492260ed86e5d677f7b11b27ba2c5e1a661b966b8082a4e3eea6e31af1a2054bef7916bbac25c2d821b000000012996b574a2581c1c24687602c866101d41aa64e39685ee7092f26af15c5329104141fda1446d65736801581c60edd22048ec0169ffd4e3ab38c9588a7ef86e16f461a1ad239b5617a15820000de140afb8a51e61565cd663fb9e2a970486d82492260ed86e5d677f7b11b2018258390008d9d743d6ee8cbec90836b8eb7a0563698a0d2a3b154cbad9ca13467c16240714ea0e12b41a914f2945784ac494bb19573f0ca61a08afa8821b000000014ccf4fb6a2581c1c24687602c866101d41aa64e39685ee7092f26af15c5329104141fda1446d65736801581c60edd22048ec0169ffd4e3ab38c9588a7ef86e16f461a1ad239b5617a15820000de140afb8a51e61565cd663fb9e2a970486d82492260ed86e5d677f7b11b201021bffffffffffffffff09a1581c0a58d318181a384a81d79e73697c8df0a5e1362fd310f0c5501beb32a140010b58202de8f95554802011b6eb801af26174e50cadc1df188fb77cdfcc1d3a16526ad30dd9010281825820486215372c0ed5247f10524e281e49b03511de08ba666aeb6fbcc218789167990512d9010281825820b4d2c065c903577147faa2d1d9e6116686f1c2e1046c4b8321582e546c9ced7e00a207d9010281590e84590e810101003323232323232322322598009919191919299919805180098059baa00213232323232598009803000c4c8c8c8c96600260320050068b202c375c602e002602e0046eb8c054004c044dd50044566002600600315980098089baa0088014590124566002600800315980098089baa00880145901245900f201e403c601e6ea801c4c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c966002603a0051323322323259800981880144c8c9660026048605c6ea800626464b3001303500289919192cc004c0e000a2646464b3001303b0028acc004c0ecc8c8cc004004094896600200314bd7044cc8966002b30013375e607e60786ea80080162605c64b3001302f303c375400314800226eb4c100c0f4dd5000a07632598009817981e1baa0018a60103d87a8000899198008009bab3041303e375400444b30010018a6103d87a80008994c004dd7181f800cdd69820000cc1100092225980099b910190038acc004cdc780c801c4c0accc114dd400125eb82298103d87a8000410513300600600141043042001410081d8c8cc004004dd598201820981e9baa0032259800800c530103d87a80008994c004dd7181f000cdd5981f800cc10c0092225980099b910190038acc004cdc780c801c4c0a8cc110dd300125eb82298103d87a800041011330060060014100304100140fd14a081d226607c0046600800800313300400400140e8607a002607c00281d8c040c0dcdd51810181b9baa0018acc00402a2b30010038cc00408a057488100a4004809229410354528206a8b20708b2070303900132330010010232259800800c52f5c113322598009815992cc004c0b0c0e4dd5000c5200089bad303d303a375400281c0c966002605860726ea80062980103d87a8000899198008009bab303e303b375400444b30010018a6103d87a80008994c004dd7181e000cdd6981e800cc1040092225980099b910160038acc004cdc780b001c4c0a0cc108dd400125eb82298103d87a800040f913300600600140f8303f00140f481c0c8cc004004dd5981e981f181d1baa303d303e303a375400644b30010018a60103d87a80008994c004dd7181d800cdd5981e000cc1000092225980099b910160038acc004cdc780b001c4c09ccc104dd300125eb82298103d87a800040f513300600600140f4303e00140f113303b00233004004001899802002000a06e303a001303b00140e066ebc018c070cc0d8dd39981b1ba900b33036375201497ae04bd704590351bae30360013036002375c60680031640c86eb0c0cc004c0bcdd5000c5902d192cc004c088c0b8dd5000c4c0c8c0bcdd5000c5902d18189819181918171baa00230203259800800c52000899191800992cc00400e2900044c008cc004004c0d400d032112cc0040062900044c00ccc008008c0d80050331b8048008c0c800502f19198008009bab3017302e375400444b30010018a5eb82264646464660020026eacc0cc010896600200310038991981b9ba733037375200a6606e60680026606e606a00297ae0330030033039002303700140d466008008606a0066eb8c0bc004c0c800503045902e1817800991980080080c112cc004006297ae0899912cc0056600266ebcc0c8c0bcdd5001006c4c8cc004004c8cc004004dd5981a181a98189baa0042259800800c52f5c1132323232330010013756606c00844b30010018801c4c8cc0e8dd39981d1ba90053303a30370013303a30380014bd7019801801981e001181d000a070330040043038003375c6064002606a0028198896600200314a1133225980099b8f375c606c00404f14a313300400400140c46eb0c0d0004c0d40050324528205a89981880119802002000c4cc01001000502d18180009818800a05c375c60580026eb8c0b0c0b4004c0a0dd500fc56600260340051323259800cc00405603d488100a4002800a33001015803c00a900120028a5040a044446464b30010018014566002606600313233225980099b8f002007899b870010068a5040c06eb8c0cc004dd69819981a00098199bac3032001801206040c06466002002601600c44b30010018a5eb8226644b30013371e6eb8c02c0080222660686e9c008cc0100100062660080080028180dd61819800981a000a06214a06464b3001302e0028992cc004c080c0a8dd5000c4c8c9660026062005132325329800981100144cdc59800801a44100899b8b3001337060060053001222598009812800c4cdc5980200124500899b8b300433706004003300100399b8600200199b8300148051003206299b8600300299b8300248051222598009812800c4cdc5980200124500899b8b300433706004003300100399b8600200199b83001480510032062205c370090302cc004cdc4000a402914800a26644b300133710002900a4520148cc00400a66e0c0052014a419002801102e1112cc004cdc40012402910018cc00400e66e0c009201499b8200148051003205e33706002900a2058375a6060605a6ea800e2c8170dd6981780098159baa0018b20523259800980f18151baa0018981718159baa0018b2052302d302e302e302a3754602660546ea80062c8158c0b0004c8cc004004058896600200314bd7044cc8966002b30013375e605e60586ea8c0bcc0c0c0b0dd5001005c4c078c966002603e60586ea80062900044dd6981818169baa00140ac64b3001301f302c375400314c103d87a8000899198008009bab3031302e375400444b30010018a6103d87a80008994c004dd71817800cdd69818000cc0d00092225980099b914881000038acc004cdc7a441000038980d9981a9ba80024bd704530103d87a800040c513300600600140c4303200140c08158c8cc004004dd59818181898169baa30303031302d375400644b30010018a60103d87a80008994c004dd71817000cdd59817800cc0cc0092225980099b910120038acc004cdc7809001c4c068cc0d0dd300125eb82298103d87a800040c113300600600140c0303100140bd14a0815226605c0046600800800313300400400140a8605a002605c002815a264b3001980080a4076910100a40028022200314a08138ca600200300b805200222259800801452844cc8966002646600200203044b30010018a50899912cc004cdc78010034528c4cc01001000502f1bae3032001303300140c115980099b884800800e33001005800ccdc0001a4002802a294502b46600200b001801a00a40ac6eb8c0b8008c0bc00902c204c409846056002604a6ea80748888c8c9660020030028acc004c0bc006264653001375c6060005375c6060003375a606060620029112cc004cdc7801805456600266e3c008026266e1c004022294102e4528205c18180009bac302e001801205840b0600c00a29408c8cc004004008896600200314bd7044ca60026eb8c09c0066eacc0a00066600600660580049111919800800801912cc004006200713233030374e660606ea4018cc0c0c0b4004cc0c0c0b80052f5c06600600660640046060002817060540028140dd718131813803181280298120029bae3023005375a604400a6eb0c084014c084c084004c080004c07cc07cc07c004c078c078004c064dd51919192cc004c044c06cdd5000c4c966002602460386ea800626464646464646464646464646464646464646464646464646464646464646464646464646464b300130470028991980080081311192cc00400a26605804026605803826605803026605802826605802026605801826605801026605800c20551323002304b003375c60920048238c00800a2c8220dd71822800982280118218009821801182080098208011bae303f001303f002303d001303d002375c60760026076004607200260720046eb8c0dc004c0dc008c0d4004c0d4008dd718198009819801181880098188011bae302f001302f002302d001302d002375c60560026056004605200260520046eb8c09c004c09c008dd6981280098128011b99375c604600260460046eb0c084004c074dd5000c5901b19192cc004c04c0062d1598009808000c5a26042603c6ea800901c2038301c3754002603e6040604060386ea8c014c070dd5180f980e1baa0018b203432330010013758603e01844b30010018a6103d87a8000899912cc004c044c9660026024603e6ea80062900044dd6981198101baa001407864b30013012301f375400314c103d87a8000899198008009bab30243021375400444b30010018a6103d87a80008994c004dd71811000cdd69811800cc09c0092225980099b914881000038acc004cdc7a4410000389807198141ba80024bd704530103d87a8000409113300600600140903025001408c80f0c8cc004004dd5980498101baa30093020375400644b30010018a60103d87a80008994c004dd71810800cdd59811000cc0980092225980099b910210038acc004cdc7810801c4c034cc09cdd300125eb82298103d87a8000408d133006006001408c3024001408913007330210024bd7044cc01001000501d18100009810800a03c22598009808980d9baa0028991919192cc004c09000a26600e006264b30013016001899192cc004c09c00a264b30013019001899192cc004c0a800a26601a00201716409c605000260486ea800a2b3001301600189919191919192cc004c0b800a01f1640ac6eb4c0b0004c0b0008dd6981500098150011bad3028001302437540051640888110c088dd5000c59024181280098109baa0028acc004c04c0062b3001302137540050068b20448b203e407c603e6ea80062c8108c088004c088008c080004c070dd500145901a11192cc004c04400626464b3001302200280245901f1bae3020001301c37540071598009807000c4c8c96600260440050048b203e375c604000260386ea800e2c80d101a180d1baa002374a90001180d980e0009bac3019301a301a301a301a004375660300066eb0c05c00cdd6180b002180b180b000980a800980a00098079baa007370e90011b8748010dd7180798061baa002370e90000b1806980700198060011805801180580098031baa0018a4d1365640106eb80055cd2ab9d5573caae7d5d02ba1574498011e581ca57faffd16a011c4d66b42337e29704f051ceb96a0fecceedab57097000105a182010082d8799f581c60edd22048ec0169ffd4e3ab38c9588a7ef86e16f461a1ad239b56175820000de140afb8a51e61565cd663fb9e2a970486d82492260ed86e5d677f7b11b2ff821a006acfc01ab2d05e00f5f6",
    //   utxos,
    //   []
    // );
  });
});
